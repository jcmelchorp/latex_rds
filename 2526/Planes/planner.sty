\ProvidesPackage{planner}
\NeedsTeXFormat{LaTeX2e}
\RequirePackage[many]{tcolorbox}
\RequirePackage[T1]{fontenc}
\RequirePackage[utf8]{inputenc}
\RequirePackage{tabularx}
\RequirePackage[landscape, margin=0.5in]{geometry}
\RequirePackage{ragged2e}
\RequirePackage{multicol,multirow}
\RequirePackage{jsonparse} % Load the json package
\RequirePackage{anyfontsize}
\RequirePackage{adjustbox}
\RequirePackage{graphicx}
\RequirePackage{xcolor}
\RequirePackage{ifthen}
\RequirePackage{xifthen}

% Configuración de tcolorbox para los títulos y bloques
\tcbset{
    titlebox/.style={
        colbacktitle=white,
        colback=blue!0.5!white,
        colframe=black,
        coltitle=black,
        boxrule=0.4pt,
        arc=2mm,
        boxsep=0mm,
        left=10pt,
        right=10pt,
        top=4pt,
        bottom=10pt,
        subtitle style={
            fontupper=\sffamily\large,
            fontlower=\huge,
            boxrule=0.4pt,
            boxsep=1mm,
            top=1mm,
            bottom=1mm,
            colback=blue!10,
            colupper=green!30!black,
        }
    },
    infobox/.style={
        coltitle=green!30!black,
        colframe=black!100,
        colback=blue!1!white,
        colbacktitle=blue!10,
        boxrule=0.4pt,
        arc=2mm,
        boxsep=1mm,
        frame style={black!100},
        left=2mm,
        right=2mm,
        top=2mm,
        bottom=2mm,
    },
}


\pagestyle{empty}
% Formato para la tabla
\newcolumntype{Y}{>{\RaggedRight\arraybackslash}X}
\renewcommand{\arraystretch}{1}
\setlength{\columnsep}{2pt}
\setlength{\arrayrulewidth}{0.1pt}

\definecolor{rdsColor}{HTML}{0060A0} % C|ustom colour
\definecolor{mathColor}{HTML}{E3A857}
\definecolor{physColor}{HTML}{228B22}
\definecolor{chemColor}{HTML}{228B22}
\definecolor{sec1Color}{HTML}{86608E}
\definecolor{sec2Color}{HTML}{4C8BA7}
\definecolor{sec3Color}{HTML}{A94939}

% Comando para mostrar el string asociado y su estilo
\newcommand{\classtitle}[1]{%
  \ifthenelse{\equal{#1}{math1}}{\textcolor{mathColor}{\textbf{Matemáticas 1}}}{}%
  \ifthenelse{\equal{#1}{math2}}{\textcolor{mathColor}{\textbf{Matemáticas 2}}}{}%
  \ifthenelse{\equal{#1}{math3}}{\textcolor{mathColor}{\textbf{Matemáticas 3}}}{}%
  \ifthenelse{\equal{#1}{chem3}}{\textcolor{chemColor}{\textbf{Química}}}{}%
  \ifthenelse{\equal{#1}{phys2}}{\textcolor{physColor}{\textbf{Física}}}{}%
  \ifthenelse{\equal{#1}{test0}}{\textcolor{red}{\textbf{TESTING}}}{}%
}

\newcommand{\leveltitle}[1]{%
  \ifthenelse{\equal{#1}{0}}{\textcolor{red}{\textbf{TESTING}}}{}%
  \ifthenelse{\equal{#1}{1}}{\textcolor{sec1Color}{\textbf{1° de Secundaria}}}{}%
  \ifthenelse{\equal{#1}{2}}{\textcolor{sec2Color}{\textbf{2° de Secundaria}}}{}%
  \ifthenelse{\equal{#1}{3}}{\textcolor{sec3Color}{\textbf{3° de Secundaria}}}{}%
}

\newcommand{\planner}[2]{%
    \def\schoolinfo{\RaggedRight%
        {\color{rdsColor}\fontsize{14}{12}\selectfont Escuela Rafael Díaz Serdán}\\[-0.5em]
        {\color{gray!40!black}\fontsize{6}{6}\selectfont \sffamily 30PES0329R \hfill turno matutino \hspace{5pt}}\\[0.5em]
        {\color{green!20!black} \fontsize{12}{12}\selectfont \sffamily Planeación didáctica semanal}\\
        {\color{black!90}{\sffamily Profesor:} Julio César Melchor Pinto}\\
        {\sffamily Disciplina:} \classtitle{#2#1} \\
        {\sffamily Grado y grupo:}  \leveltitle{#1}\\
    }
    \JSONParseFromFile{\weekdata}{#2#1.json}
}

\def\LOGO{%
    \begin{picture}(0,0)\unitlength=2cm
        \put (-0.065,-0.49) {\includegraphics[width=1.8cm]{logo_shadow.png}}
        \put (-0.07,-0.48) {\includegraphics[width=1.8cm]{logo.png}}
    \end{picture}
}

% Comando para el diseño del encabezado
\newcommand*\planTitle[8]{\small%
	\def\fechaini{#7}
	\def\fechaend{#8}
    \begin{minipage}{0.07\textwidth}
        \LOGO
    \end{minipage}%
    \begin{minipage}{0.23\textwidth}
        \schoolinfo
    \end{minipage}%
    \begin{tabularx}{0.7\textwidth}{rYrl}
        {\sffamily Ciclo escolar:} & 2025-2026 & {\sffamily Trimestre:} &  Unidad {#5} \\
        {\sffamily Campo formativo:} & Saberes y Pensamiento Científico &{\sffamily Período:} &   #7 {\sffamily al} #8 \\ % #7 {\sffamily al} #8 \\  %
        {\sffamily Tema:}  & \multirow[t]{2}{\linewidth}{#3} &{\sffamily Semana:} &  {#6}\\
        & & {\sffamily Duración:} & 6 horas \\
        {\sffamily Contenido:}  &  \multicolumn{3}{l}{#2}\\
        {\sffamily Ejes articuladores:} &   \multicolumn{3}{l}{#1}\\
        {\sffamily Lección:} &   \multicolumn{3}{l}{#4}\\ 
    \end{tabularx}
}

\newcommand*\weekcontents[3]{%
    \tcbsubtitle{INICIO}
    \tcboxfit[colback=white,colframe=white,top=0mm,bottom=0mm,left=0mm,right=0mm,height=2.5cm]{#1}
    \tcbsubtitle{DESARROLLO}
    \tcboxfit[colback=white,colframe=white,top=0mm,bottom=0mm,left=0mm,right=0mm,height=5cm]{#2}
    \tcbsubtitle{CIERRE}
    \tcboxfit[colback=white,colframe=white,top=0mm,bottom=0mm,left=0mm,right=0mm,height=2cm]{#3}
}

\newcommand*\weekbottom[2]{%
\begin{multicols}{3}\centering
    \begin{tcolorbox}[infobox, title={\sffamily \large Proceso de desarrollo de aprendizaje (PDA):}]
    \tcboxfit[colback=white,colframe=white,top=0mm,bottom=0mm,left=0mm,right=0mm,height=1.5cm, fit basedim=11pt]{#1}
    \end{tcolorbox}%
    \begin{tabularx}{0.95\linewidth}{|c|c|}
        \multicolumn{1}{p{0.45\linewidth}}{\centering \sffamily Elabora:}  & \multicolumn{1}{p{0.45\linewidth}}{\centering \sffamily Autoriza:}                \\
        \hline
        \multicolumn{1}{Y|}{\vspace{3em}\centering \footnotesize \sffamily Nombre y firma} & \multicolumn{1}{Y}{\vspace{3em}\centering \footnotesize \sffamily Nombre y firma} \\
    \end{tabularx}%
    \begin{tcolorbox}[infobox, title={\sffamily \large Instrumento y estrategia de evaluación:}]
    \tcboxfit[colback=white,colframe=white,top=0mm,bottom=0mm,left=0mm,right=0mm,height=1.5cm, fit basedim=11pt]{#2}
    \end{tcolorbox}%
\end{multicols}
}
